<!doctype html><html lang="fr"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Catalogue ‚Äî HousesApp</title><link rel="stylesheet" href="assets/style.css"><script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script></head><body>
<div class="container">
  <div class="header"><div class="brand"><div class="logo">H</div><div><div class="title">HousesApp</div><div class="lang">Liste des maisons</div></div></div></div>
  <div class="card"><div class="row"><input id="q" class="input" placeholder="Rechercher..."><select id="filter" class="input"><option value=''>Tous</option><option value='starred'>Favoris</option><option value='completed'>Compl√©t√©s</option></select><button id="btnSearch" class="btn">Go</button></div><div id="houses" class="house-list" style="margin-top:12px"></div></div>
</div>
<script src="assets/app.js"></script>
<script>
const SUPABASE_URL = "https://jethjfwkitfgjnbbldgm.supabase.co";
const SUPABASE_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImpldGhqZndraXRmZ2puYmJsZGdtIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTY2Njk1OTIsImV4cCI6MjA3MjI0NTU5Mn0.ZOQG4wu9CxfEbTNB4pfmO0YWHX5Hsb7OZ841ddOKjJg";
const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_KEY);
async function loadHouses(q='', filter=''){ const wrap=document.getElementById('houses'); wrap.innerHTML='Loading...'; const { data, error } = await supabase.from('houses').select('*').order('id',{ascending:false}); if(error){ wrap.innerHTML='<div class="kv">Erreur</div>'; return; } let results = data || []; if(q) results = results.filter(h=> (h.title||'').toLowerCase().includes(q.toLowerCase()) || (h.address||'').toLowerCase().includes(q.toLowerCase())); if(filter==='starred') results = results.filter(h=>h.starred); if(filter==='completed') results = results.filter(h=>h.completed); wrap.innerHTML=''; if(!results.length){ wrap.innerHTML='<div class="kv">Aucune maison</div>'; return; } results.forEach(h=>{ const el=document.createElement('div'); el.className='house'; el.innerHTML = `<div class='media'><img src='${h.before_image||h.image_url||"https://via.placeholder.com/400x240"}'></div><div class='meta'><h3>${h.title||'-'}</h3><div class='icon-row'><div class='icon'>üõèÔ∏è<strong>${(h.double_beds||0)}/${(h.single_beds||0)}</strong></div><div class='icon'>üõÅ<strong>${h.bathrooms||0}</strong></div><div class='icon'>üöΩ<strong>${h.toilets||0}</strong></div></div><div style='margin-top:8px;color:var(--muted)'>${h.address||''}</div><div class='timestamp'>${h.scheduled_for? 'Planifi√©: '+new Date(h.scheduled_for).toLocaleString():''}</div></div><div class='actions'><button class='small' onclick='openMap("${encodeURI(h.map_url||'')}")'>Map</button><button class='small' onclick='window.location.href="index.html"'>Connexion</button></div>`; wrap.appendChild(el); }); }
document.getElementById('btnSearch').addEventListener('click', ()=> loadHouses(document.getElementById('q').value, document.getElementById('filter').value));
loadHouses();
</script></body></html>
